# Cpu emulator
#### Данный проект включает в себя три основные части: компилятор языка ассемблера с упрощенным набором команд, дизасемблер и эмулятор процессора.
## Getting started
#### Если вам очень хочется поиграться с кодом, то следующие шаги позволят вам установить проект к себе.
### Instalation
#### Windows: Visual Studio
1. Вам необходимо скачать код проекта в отдельную директорию.
2. В Visual Studio открыть меню Файл > Создать > Проект из существующего кода.
3. В открывшемся окне типом проекта выбираем Visual C++, нажимаем далее.
4. Указываем расположение файла и <имя проекта>, нажимаем далее.
5. В качестве типа проекта выбираем консаольное приложение, нажимаем готово.
6. Переходим в свойства исполняемого проекта: Отладка > <Имя проекта>: свойства. 
7. Меняем опцию Общее>Версия пакета SDK для Windows на ту, которая установлена у вас.

[Картинки с последовательностью шагов](./images/) могут улучшить понимание происходящего.
#### Linux
Достаточно скачать проект в любую свободную директорию, а затем вызвать make:

    $make
### Usage
#### После сборки проекта у вас появится исполняемый файл, с которым можно работать через аргументы командной строки. Ниже перечислены флаги, задающие режим работы.
* **-p <program name>**  
В качестве параметра <program name> можно указать три значения:  compilator, disassembler, cpu. Выставление флага
задает режим работы программы: компилятор, дизасемблер или режим работы эмулятора процессора.
**Данный флаг является обязательным при запуске программы.**
* **-i <имя файла>**  
Флаг указывает программе, какой файл будет считаться входным. Из него считываются данные для дальнейшей работы.
* **-o <имя файла>**  
Флаг указывает программе файл, в который будет записываться результат выполнения.
* **-l <имя файла>**  
Флаг позволяет указать имя файла лога, по умолчанию файл будет называться log.log
* **-ln**  
Если данный флаг включен, то файл лога не создается, а вся отладочная информация выводиться на экран.
* **-m <число байт>**
Данный флаг указывает размер виртуальной памяти процессора.
* **-stbs**
Данный флаг устанавливает режим "STEP BY STEP" выполнения программы процессора, после каждой команды выводится полная информация о процессоре на экран.
* **-r**
Данный флаг последовательно запускает компилятор, считывая код из файла, указанного через **-i**, затем выполняет скомпилированный код. Результат компиляции записывается в "a.bin".
* **-t**
Флаг запускает тестирующие программы, которые расположены в папке Tests.

#### Примеры использования некоторых флагов:

    >ProgramManager.exe -p compilator -i ASM_CODE.txt -o prog.bin
    $./ProgramManager.out -p compilator -i ASM_CODE.txt -o prog.bin
Выполнение команды произведет компиляцию программы из файла ASM_CODE.asm, результат будет записан в prog.bin. Все ошибки будут записаны в log.log

    >ProgramManager.exe -p disassembler -i prog.bin -o disasm.txt
    $./ProgramManager.out -p disassembler -i prog.bin -o disasm.txt
Выполнение команды произведет дизассемблирование программы из prog.bin, результат будет записан в disasm.asm. Все ошибки будут записаны в log.log

    >ProgramManager.exe -p cpu -i prog.bin
    $./ProgramManager.out -p cpu -i prog.bin
Выполнение команды запустит эмуляцию программы из prog.bin на виртуальном процессоре. Результат выполения эмуляции будет выведен в log.log

## Todo list
- [x] Реализовать стандартные операции mov, add, sub, mul, div.
- [x] Реализовать работу с метками и команду jmp безусловного перехода.
- [x] Реализовать регистр флагов, команду cmp и условные переходы je, jne, ja, jae, jb, jbe.
- [x] Реализовать сегментные регистры ecs, eds, ess.
- [x] Реализовать команды работы со стеком push, pop.
- [x] Реализовать команды call, ret.
- [x] Реализовать возможность обращения команд к виртуальной памяти.
- [x] Добавить флагов для управления режимом эмуляции процессора.
- [x] Сделать cmake файл для сборки проекта в gcc.
- [x] Добавить возможность писать комментарии в коде на ASM
- [x] Добавить возможность расширять набор команд, дописыванием скрипта в отдельный файл.
- [x] Добавлена возможность работы с вещественными числами 
